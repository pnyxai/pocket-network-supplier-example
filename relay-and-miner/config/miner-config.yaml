# Miner Configuration for Docker Compose
# This config is optimized for local development with docker-compose.

redis:
  url: "redis://redis:6379"
  consumer_name: ""
  claim_idle_timeout_ms: 60000

pocket_node:
  query_node_rpc_url: "https://sauron-rpc.beta.infra.pocket.network"
  query_node_grpc_url: "sauron-grpc.beta.infra.pocket.network:443"
  grpc_insecure: false
  query_timeout_seconds: 5

keys:
  keys_file: "/keys/supplier-keys.yaml"

block_time_seconds: 60

block_health_monitor:
  enabled: true
  slowness_threshold: 1.5

balance_monitor:
  enabled: true
  check_interval_seconds: 300
  balance_threshold_upokt: 10000
  stake_warning_proof_threshold: 10
  stake_critical_proof_threshold: 3

session_lifecycle:
  max_concurrent_transitions: 10

# Worker pool configuration 
# Formula: max(cpu × cpu_multiplier, suppliers × workers_per_supplier) + overhead
worker_pools:
  master_pool_size: 0           # 0 = auto-calculate (recommended)
  cpu_multiplier: 4             # CPU multiplier for baseline sizing
  workers_per_supplier: 2       # Workers per supplier (claim + proof parallel)
  query_workers: 20             # Fixed workers for blockchain queries
  settlement_workers: 2         # Fixed workers for settlement events

leader_election:
  leader_ttl_seconds: 30
  heartbeat_rate_seconds: 10

deduplication_ttl_blocks: 10
batch_size: 1000
hot_reload_enabled: true
cache_ttl: "2h"

# Pre-discovered applications from genesis
known_applications:
  - "pokt1wvn4a8kj4mfnq0cjakadskxwr2zkev35psjxh9" 

transaction:
  # Automatic gas estimation (recommended)
  gas_limit: 0
  gas_price: "0.000001upokt"
  # Using 2.5 instead of default 1.7 to verify config is actually loaded
  gas_adjustment: 2.5

metrics:
  enabled: true
  addr: "0.0.0.0:9092"

pprof:
  enabled: true
  addr: "0.0.0.0:6065"

logging:
  level: "info"
  format: "json"
  output: "stdout"
  async: true
  async_buffer_size: 100000